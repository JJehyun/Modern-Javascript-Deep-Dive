# Docker COMPOSE ğŸ¯ğŸ’¡ğŸ”¥ğŸ“Œâœ…

> `Docker Composeë€ ë‹¤ì¤‘ ì»¨í…Œì´ë„ˆ ë„ì»¤ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì •ì˜í•˜ê³  ì‹¤í–‰í•˜ê¸° ìœ„í•œ ë„êµ¬`

```bash
## ê°„ë‹¨í•œ redisì„¤ëª…
ğŸ’¡ redis
- ë©”ëª¨ë¦¬ ê¸°ë°˜ì˜ í‚¤-ê°’ êµ¬ì¡° ë°ì´í„° ê´€ë¦¬ ì‹œìŠ¤í…œì´ë©°, ëª¨ë“  ë°ì´í„°ë¥¼ ë©”ëª¨ë¦¬ì— ì €ì¥í•˜ê³  ë¹ ë¥´ê²Œ ì¡°íšŒí•  ìˆ˜ ìˆëŠ” ë¹„ê´€ê³„í˜• ë°ì´í„° ë² ì´ìŠ¤ì´ë‹¤

ğŸ’¡ ì‚¬ìš©ì´ìœ 
- ë©”ëª¨ë¦¬ì— ì €ì¥í•˜ê¸° ë•Œë¬¸ì— ë°ì´í„° ë² ì´ìŠ¤ë³´ë‹¤ ì†ë„ ë¹ ë¦„
- ë©”ëª¨ë¦¬ì— ì €ì¥í•˜ì§€ë§Œ ì˜ì†ì ìœ¼ë¡œ ë³´ê´€ ê°€ëŠ¥
- ì„œë²„ ì¬ë¶€íŒ… ì‹œì—ë„ ë°ì´í„°ë¥¼ ìœ ì§€í•  ìˆ˜ ìˆë‹¤.
```

- ![image](../../image/d19.png)
  - `ì„œë¡œ ë‹¤ë¥¸ ì»¨í…Œì´ë„ˆì—ì„œ ì•„ë¬´ëŸ° ì„¤ì •ì—†ì´ ì ‘ê·¼/í†µì‹ ì„ í•  ìˆ˜ ì—†ë‹¤.`
  - ë©€í‹° ì»¨í…Œì´ë„ˆ ìƒí™©ì—ì„œ ì‚¬ìš©í•˜ëŠ” ê²ƒ : `Docker Compose`

<br />

## í´ë” êµ¬ì¡° ë° ì†ŒìŠ¤ ì½”ë“œ (1)

> í˜„ì¬ í´ë” êµ¬ì¡°

```js
root/
  - /node_modules
  - dockerfile
  - package.json
  - server.js



// server.js ì½”ë“œ
// server.js ì½”ë“œ
// server.js ì½”ë“œ
server.js
const express = require("express");
const redis = require("redis");
const client = redis.createClient({
  socket: {
    host: "redis-server",

    port: 6379,
  },
});
const app = express();
app.get("/", async (req, res) => {
  await client.connect();
  let number = await client.get("number");
  if (number === null) {
    number = 0;
  }
  console.log("Number: " + number);
  res.send("ìˆ«ìê°€ 1ì”© ì˜¬ë¼ê°‘ë‹ˆë‹¤. ìˆ«ì: " + number);
  await client.set("number", parseInt(number) + 1);
  await client.disconnect();
});

//dockerfile
//dockerfile
# osëŠ” node10 ë²„ì „ ì‚¬ìš©
FROM node:10
WORKDIR /usr/src/app
COPY package.json ./
RUN npm install
COPY  ./ ./
CMD ["node","server.js"]
```

<br />

## docker Compose íŒŒì¼ ì‘ì„±í•˜ê¸°(2)

- ![image](../../image/d21.png)
- ![image](../../image/d20.png)

- ì»¨í…Œì´ë„ˆ ì‚¬ì´ì— ë„¤íŠ¸ì›Œí¬ë¥¼ ì—°ê²° ì‹œì¼œì£¼ëŠ” ê²ƒ : `Docker Compose`

> docker-compose.yml íŒŒì¼ ì–‘ì‹

```bash
version: "3"  (ë„ì»¤ ì»´í¬ì¦ˆ ë²„ì „)
services:  (ì´ê³³ì— ì‹¤í–‰í•˜ë ¤ëŠ” ì»´í…Œì´ë„ˆë“¤ì„ ì •ì˜)
  redis-server: (ì»¨í…Œì´ë„ˆ ì´ë¦„)
    image: "redis" (ì»¨í…Œì´ë„ˆì—ì„œ ì‚¬ìš©í•˜ëŠ” ì´ë¯¸ì§€)
  node-app: (ì»¨í…Œì´ë„ˆ ì´ë¦„)
    build: . (í˜„ ë””ë ‰í† ë¦¬ì— ìˆëŠ” Dockfile ì‚¬ìš©)
    ports:    (í¬íŠ¸ ë§¤í•‘)
      - "5000:8080"

--------------------------------------------------

version: "3"
services:
  redis-server:
    image: "redis"
  node-app:
    build: .
    ports:
      - "5555:8080"
```

<br />

## docker Composeë¡œ íŒŒì¼ ì‹¤í–‰/ì¢…ë£Œí•˜ê¸°(3)

- ![image](../../image/d22.png)
- ![image](../../image/d24.png)
  - ì»¨í…Œì´ë„ˆ ë°±ê·¸ë¼ìš´ë“œ ì‹¤í–‰ ëª…ë ¹ì–´
    > docker compose ì‹¤í–‰ ëª…ë ¹ì–´

```bash
docker-composeup VS docker-compose up --build

# ì´ë¯¸ì§€ê°€ ì—†ì„ë•Œ ì´ë¯¸ì§€ë¥¼ ë¹Œë“œí•˜ê³  ì»¨í…Œì´ë„ˆ ì‹œì‘
ğŸ’¡ docker-composeup

# ì´ë¯¸ì§€ê°€ ìˆë“  ì—†ë“  ì´ë¯¸ì§€ë¥¼ ë¹Œë“œí•˜ê³  ì»¨í…Œì´ë„ˆ ì‹œì‘
ğŸ’¡ docker-compose up --build
```

<br />
<br />

> docker compose ì¢…ë£Œ ëª…ë ¹ì–´

```bash
# docker ì¢…ë£Œí•˜ê¸°
ğŸ’¡ docker down
```
