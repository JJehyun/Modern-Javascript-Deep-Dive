# ì¸ì¦ê³¼ ì‚¬ìš©ì ì„¸ì…˜ ê´€ë¦¬ ğŸ¯ğŸ’¡ğŸ”¥ğŸ“Œâœ…

<br />

## ì—¬ëŸ¬ ì¸ì¦ ë°©ì‹

- `ìê²© ì¦ëª… ê¸°ë°˜ ì¸ì¦`

  - ì‚¬ìš©ìì˜ ìê²©ì„ ì¦ëª…í•  ìˆ˜ ìˆëŠ” ë¹„ë°€ ì •ë³´ë¥¼ í†µí•´ ì‚¬ìš©ìë¥¼ ì‹ë³„í•œë‹¤.
  - `ex) ë¹„ë°€ë²ˆí˜¸, ì´ë©”ì¼ ì£¼ì†Œ`

- `ì†Œì…œ ë¡œê·¸ì¸`
  - í˜ì´ìŠ¤ë¶, íŠ¸ìœ„í„°, êµ¬ê¸€ ê°™ì€ ì†Œì…œ ê³„ì •ì„ ì‚¬ìš©í•´ì„œ ì‹œìŠ¤í…œì— ë¡œê·¸ì¸í•˜ëŠ” ë°©ì‹
- `ë¹„ë°€ë²ˆí˜¸ ì—†ì´ ë¡œê·¸ì¸`

  - ì‚¬ìš©ìì˜ ì´ë©”ì¼ë¡œ ì†Œìœ„ `ë§¤ì§ ë§í¬`ë¼ëŠ” ê²ƒì„ ë³´ë‚´ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì§€ ì•Šê³  ì¸ì¦í•˜ëŠ” ë°©ì‹

- `ì‹±ê¸€ ì‚¬ì¸ì˜¨(SSO)`
  - ê°ê¸° ë‹¤ë¥¸ ì„œë¹„ìŠ¤ì— ê³ ìœ í•œ ìê²© ì¦ëª…ì„ ë°œê¸‰í•˜ê³  ì¤‘ì•™ì—ì„œ ì‚¬ìš©ì ì¸ì¦ì„ ì²˜ë¦¬í•œë‹¤.

<br />
<br />

```
ğŸ“Œ ìŠ¤í…Œì´íŠ¸í’€ ì„¸ì…˜

- `ì„¸ì…˜ ì¿ í‚¤`ë¥¼ ë§Œë“¤ê³  í•´ë‹¹ `ì„¸ì…˜`ê³¼ `ê´€ë ¨ëœ ëª¨ë“  ì†ì„±`ì„ ê´€ë¦¬í•œë‹¤
- ì‚¬ìš©ì ìƒíƒœë¥¼ ì „ë¶€ ì„œë²„ì—ì„œ ê´€ë¦¬í•˜ê³  íŠ¹ì • ì„¸ì…˜ ì¿ í‚¤ë¥¼ ì‚¬ìš©í•´ì„œ ì´ ì„¸ì…˜ì„ í•´ë‹¹ í´ë¼ì´ì–¸íŠ¸ì™€ ì—°ê²°í•œë‹¤.
- ì• í”Œë¦¬ì¼€ì´ì…˜ ê·œëª¨ê°€ ì ì  ì»¤ì§€ë©´ ë³µì¡í•´ì§€ê¸° ì¼ì‘¤ì´ë‹¤.
- ex) ë¡œê·¸ì¸í•œ ì‚¬ìš©ì ì„¸ì…˜ì— ì‚¬ìš©ì ì´ë©”ì¼ ë˜ëŠ” ê³„ì • ì´ë¦„ì„ ê¸°ë¡í•´ë‘ê³  í˜ì´ì§€ë¥¼ ë Œë”ë§í•  ë•Œë§ˆë‹¤ ì´ì •ë³´ë¥¼ ê°€ì ¸ì™€ì„œ ì‚¬ìš©í•˜ëŠ” ë°©ì‹
```

<br />

```
ğŸ“Œ ìŠ¤í…Œì´íŠ¸ë¦¬ìŠ¤ ì„¸ì…˜ (JWT ê¸°ë°˜ ì¸ì¦)

- ì„¸ì…˜ ì¿ í‚¤ë¥¼ ì„œë²„ê°€ ì•„ë‹Œ í”„ë¡ íŠ¸ì—”íŠ¸ ìª½ì— ë‘ê³  ìƒˆë¡œìš´ ìš”ì²­ì„ ë³´ë‚¼ ë•Œë§ˆë‹¤ ì‚¬ìš©ìë¥¼ ì‹ë³„í•  ìˆ˜ ìˆëŠ” ì •ë³´ë¥¼ í•¨ê»˜ ë³´ë‚´ëŠ” ë°©ì‹ì´ë‹¤.
- ë¡œê·¸ì¸í•œ ì‚¬ìš©ìê°€ ë°±ì—”ë“œì— ìš”ì²­ì„ ë³´ë‚¼ ë•Œ ë§ˆë‹¤ ì¸ì¦ ë°©ì‹ì— ë”°ë¼ ì¸ì¦ì— í•„ìš”í•œ ì •ë³´ë¥¼ HTTP í—¤ë” ë˜ëŠ” ì¿ í‚¤ë¡œ ë³´ë‚´ëŠ” ê²ƒì´ë‹¤.
- ì„œë²„ëŠ” ì´ ì¸ì¦ ì •ë³´ë¥¼ ë°›ì•„ì„œ ê²€ì¦í•˜ê³  ì‚¬ìš©ìë¥¼ ì‹ë³„í•œ ë‹¤ìŒ ê¶Œí•œì— ë”°ë¼ ì‚¬ìš©ìê°€ ìš”êµ¬í•œ ì„œë¹„ìŠ¤ ë˜ëŠ” ì½˜í…ì¸ ë¥¼ ì œê³µí•œë‹¤.
```

<br />
<br />

## Json web token

> ê³µê°œëœ ì‚°ì—… í‘œì¤€ ë°©ì‹ìœ¼ë¡œ ì¸ì¦ì— ì°¸ì—¬í•˜ëŠ” ë‘ ëŒ€ìƒ ê°„ì— í´ë ˆì„ì„ ì•ˆì „í•˜ê²Œ ì£¼ê³ ë°›ì„ ìˆ˜ ìˆëŠ” ë°©ë²•ì´ë‹¤. <br /> `base64` ë°©ì‹ìœ¼ë¡œ ì¸ì½”ë”©ëœ ì„¸ ê°œì˜ json ë°ì´í„°ë¥¼ í•˜ë‚˜ë¡œ ì—°ê²°í•œ ê²ƒì´ë‹¤.

- JWTëŠ” `ì `ìœ¼ë¡œ ì—°ê²°ëœ ì„¸ë¶€ë¶„ì˜ ë°ì´í„°ë¡œ ë‚˜ëˆŒ ìˆ˜ ìˆë‹¤.
  - ì²«ë²ˆì§¸ ë¶€ë¶„ : JWT í—¤ë” ë¶€ë¶„ `ë‘ê°€ì§€ì˜ í•µì‹¬ ì •ë³´`
    - 1. `í† í° íƒ€ì…`
    - 2. `í† í°ì„ ì‚¬ì¸í•  ë•Œ ì‚¬ìš©í•œ ì•Œê³ ë¦¬ì¦˜`
  - ë‘ë²ˆì§¸ ë¶€ë¶„ : `í˜ì´ë¡œë“œ`
    - ì‚¬ìš©ìë¥¼ ì‹ë³„í•˜ê¸° ìœ„í•œ ë¯¼ê°í•˜ì§€ ì•Šì€ ë°ì´í„°
    - JWT í˜ì´ë¡œë“œëŠ” ëˆ„êµ¬ë‚˜ ë³¼ ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ë¯¼ê°í•œ ë°ì´í„°ëŠ” í¬í•¨ì‹œí‚¤ë©´ ì•ˆëœë‹¤.
  - ì„¸ë²ˆì§¸ ë¶€ë¶„: `ì‹œê·¸ë‹ˆì²˜`
    - ì‚¬ì¸ì„ ì•ˆì „í•˜ê²Œ

> í•„ìš”í•œ ì‚¬ìš©ì ê´€ë ¨ ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ë©´ jwtë¥¼ ì¿ í‚¤ ë˜ëŠ” HTTP ì¸ì¦ í—¤ë”ì˜ bearer í† í°ìœ¼ë¡œ ì§€ì •í•´ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

<BR />

> JWT ì˜ˆì‹œ

```BASH
#ì²«ë²ˆì§¸ ë¶€ë¶„
{
  # í† í° ì‚¬ì¸ì— ì‚¬ìš©í•œ ì•Œê³ ë¦¬ì¦˜
  "alg" : "HS256",
  # í† í° íƒ€ì…
  "typ" : "JWT"
}
#ë‘ ë²ˆì§¸ ë¶€ë¶„
{
  # jwt ì„œë¸Œì íŠ¸
  "sub" : "908eafa7-71bd-4203-8f76-b6072cd11e87",
  # ì‚¬ìš©ì ì´ë¦„
  "name":"kim",
  # í† í° ë°œí–‰ ì¼ì‹œ
  "iat" : 1516239022
}
```

<br />

```
ğŸ¯ ëˆ„êµ¬ë‚˜ JWTë¥¼ ì½ê³  í’€ì–´ë³¼ ìˆ˜ ìˆë‹¤. í•˜ì§€ë§Œ JWTë¥¼ ìˆ˜ì •í•˜ë”ë¼ë„ ì‚¬ì¸ì— ì‚¬ìš©í•œ ë¹„ë°€ê°’ì„ ì•Œì§€ ëª»í•œë‹¤ë©´ ì‚¬ì¸ì„ ë‹¤ì‹œ ë§Œë“¤ê³  ê²€ì¦ ê³¼ì •ì„ í†µê³¼í•  ìˆ˜ ì—†ë‹¤.
```

<br />

---

## ì»¤ìŠ¤í…€ ì¸ì¦ ì„œë²„ ğŸ¯ğŸ’¡ğŸ”¥ğŸ“Œâœ…

<BR />
<BR />

> ë¡œê·¸ì¸ API `/pages/api/login.js`

```js
// /pages/api/login.js
// ì´ í•¨ìˆ˜ëŠ” ì‚¬ìš©ì ì…ë ¥ì„ ë°›ê³  ì¸ì¦ì„ ì²˜ë¦¬í•œë‹¤. POSTìš”ì²­ë§Œ ì…ë ¥ì„ ë°›ë„ë¡ í•œë‹¤.
export default (req, res) => {
  const { method } = req;
  const { email, password } = req.body;

  if (method !== "POST") {
    return res.status(404).end();
  }

  if (!email || !password) {
    return res.status(400).json({
      error: "Missing required params",
    });
  }

  const user = authenticateUser(email, password);

  if (user) {
    res.setHeader(
      "Set-Cookie",
      // myauthë¼ëŠ” ì¿ í‚¤ë¥¼ ë§Œë“¤ê³  ê·¸ì•ˆì— ì‚¬ìš©ì jwtë¥¼ ì €ì¥í•œë‹¤.
      //í´ë¼ì´ì–¸íŠ¸ ì¸¡ì—ì„œ ë°œìƒí•  ìˆ˜ ìˆëŠ” ì ì¬ì ì¸ ë³´ì•ˆ ìœ„í—˜ì„±ì„ ì‚¬ì „ì— ì°¨ë‹¨í•œë‹¤.
      // httpOnly í”Œë˜ê·¸ë¥¼ trueë¡œ ì„¤ì •í•´ ì„œë²„ ì¸¡ì—ì„œë§Œ ì¿ ê¸°ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ í•´ì•¼ ë°ì´í„°ë¥¼ ì¢€ ë” ì•ˆì „í•˜ê²Œ ì €ì¥í•  ìˆ˜ ìˆë‹¤.
      serialize("my_auth", user, { path: "/", httpOnly: true })
    );
    return res.json({ success: true });
  } else {
    return res.status(401).json({
      success: false,
      error: "Wrong email of password",
    });
  }
};
```

```
ğŸ“Œ Nest.js APIê²½ë¡œëŠ” ëª¨ë“  HTTPë©”ì„œë“œë¥¼ í—ˆìš©í•œë‹¤. í•˜ì§€ë§Œ íŠ¹ì • ë¼ìš°íŠ¸ì˜ ê²½ìš° íŠ¹ì • ë©”ì„œë“œë§Œ í—ˆìš©í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤.

ex) ìƒˆë¡œìš´ ì½˜í…ì¸ ë¥¼ ë§Œë“¤ ë•Œ POSTë§Œ í—ˆìš©í•˜ê³ , ë°ì´í„°ë¥¼ ì½ì„ ë•ŒëŠ” GET, ë©”ì„œë“œ ìˆ˜ì • PUT, ì‚­ì œëŠ” DELETEë§Œ í—ˆìš©
```

<BR />
<BR />

> ì¸ì¦ ê´€ë ¨ ì»¤ìŠ¤í…€ í›…

```JS
import { useState, useEffect } from 'react';

export function useAuth() {
  const [loggedIn, setLoggedIn] = useState(false);
  const [user, setUser] = useState(null);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState(null);

  useEffect(() => {
    setLoading(true);
    // useEffectí›…ì´ ì‹œì‘ë˜ë©´ /api/get-session APIë¡œ HTTP ìš”ì²­ì„ ë³´ë‚¸ë‹¤.
    //API í˜¸ì¶œì´ ì„±ê³µ, ì‹¤íŒ¨ë˜ë©´ ì‚¬ìš©ì ìƒíƒœë‚˜ ì—ëŸ¬ê°’ì„ ë°˜í™˜í•˜ê³  Loading ìƒíƒœê°’ì„ falseë¡œ ë§Œë“¤ì–´ì„œ uië¥¼ ë‹¤ì‹œ ë Œë”ë§í•˜ë„ë¡í•œë‹¤.
    fetch('/api/get-session')
      .then((res) => res.json())
      .then((data) => {
        if (data.loggedIn) {
          setLoggedIn(true);
          setUser(data.user);
        }
      })
      .catch((err) => setError(err))
      .finally(() => setLoading(false));
  }, []);

  return {
    user,
    loggedIn,
    loading,
    error,
  };
}
```

<br />

> ìœ„ ì»¤ìŠ¤í…€ í›…ì„ ì´ìš©í•´ì„œ ì‚¬ìš©ìê°€ ì¸ì¦ë°›ì€ ìƒíƒœì—ì„œë§Œ ì½˜í…ì¸ ë¥¼ í‘œì‹œí•˜ë„ë¡ ë§Œë“¤ê¸°

```js
import { useRouter } from "next/router";
import { useAuth } from "../lib/hooks/auth";
import styles from "../styles/app.module.css";

export default function ProtectedRoute() {
  const router = useRouter();
  const { loading, error, loggedIn } = useAuth();

  if (!loading && !loggedIn) {
    router.push("/login");
  }

  return (
    <div className={styles.container}>
      {loading && <p>Loading...</p>}
      {error && <p> An error occurred. </p>}
      {loggedIn && (
        <>
          <h1>Protected Route</h1>
          <p>You can't see me if not logged-in!</p>
        </>
      )}
    </div>
  );
}
```

<br />
<br />
<br />

## Auth0 ë¥¼ ì´ìš©í•œ ë¡œê·¸ì¸ ì²˜ë¦¬

- Auth0ë¥¼ ì‚¬ìš©í•˜ë©´ ë¡œê·¸ì¸,ë¡œê·¸ì•„ì›ƒ,ë¹„ë°€ë²ˆí˜¸ ì´ˆê¸°í™” ë“±ì˜ ê°™ì€ ìˆ˜ë§ì€ ê¸°ëŠ¥ì„ ë”°ë¡œ êµ¬í˜„ í•´ì•¼í•˜ì§€ë§Œ, Auth0ë¥¼ ì‚¬ìš©í•˜ë©´ ì´ ëª¨ë“  ê¸°ëŠ¥ì„ ì œê³µí•´ì¤€ë‹¤.

<br />
<br />

> ìƒìš© ìˆ˜ì¤€ì˜ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë§Œë“¤ ë•ŒëŠ” ì´ë¯¸ ë§Œë“¤ì–´ì§„ ì™¸ë¶€ ì¸ì¦ ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ë³´ì•ˆì´ë‚˜ ì‹ ë¢°ë„ ì¸¡ë©´ì—ì„œ í›¨ì”¬ ì¢‹ì€ ì¸¡ë©´ì´ë‹¤.

<br />

> .env.local

```bash
# AUTH0_SECRET
AUTH0_SECRET=f9123124e1231234r213215f123534
AUTH0_BASE_URL='http://localhost:3000'
AUTH0_ISSUER_BASE_URL='http://your_auth0_domin.auth0.com'
AUTH0_CLIENT_ID="YOUR_AUTH0_CLIENT_ID"
AUTH0_CLIENT_SECRET="YOUR_AUTH0_CLIENT_SECRET"
```

<br />

- `AUTH0_SECRET` : ì„ì˜ë¡œ ìƒì„±ëœ ë¬¸ìì—´ê°’ìœ¼ë¡œ Auth0ê°€ ì„¸ì…˜ ì¿ í‚¤ê°’ì„ ì•”í˜¸í™”í•  ë•Œ ì‚¬ìš©í•  ë¹„ë°€í‚¤
- `AUTH0_BASE_URL` : ì• í”Œë¦¬ì¼€ì´ì…˜ ê¸°ë³¸ URL , ë¡œì»¬ì—ì„œ ê°œë°œí•˜ëŠ” ê²½ìš° : `http://localhost:3000`
- `AUTH0_ISSUER_BASE_URL` : Auth0 ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ URLì´ë‹¤. ì½œë°± URLì„ ì§€ì •í•˜ëŠ” `[Setting]` í™”ë©´ì˜ `[Domin]`ì´ ì—¬ê¸° í•´ë‹¹í•œë‹¤.
- `AUTH0_CLIENT_ID` : Auth0 ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ í´ë¼ì´ì–¸íŠ¸ ID
- `AUTH0_CLIENT_SECRET` : Auth0 ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ í´ë¼ì´ì–¸íŠ¸ ë¹„ë°€ê°’

<br />

---

## Auth0ë¥¼ ì´ìš©í•´ì„œ ì¸ì¦ ë°©ì‹ ì²˜ë¦¬í•˜ê¸°

<br />

> 1. Auth0 ì„¤ì¹˜

```
$ yarn add @auth0/nextjs-auth0
```

<br />

> 2. page/api/auth/[...auth0].js

```js
import { handleAuth } from "@auth0/nextjs-auth0";

export default handelAuth();
```

<br />

> 3. handleAuth() ë©”ì„œë“œ ì´ìš©í•˜ê¸°

```bash
# Next.js ì„œë²„ë¥¼ ì‹œì‘í•˜ë©´ handleAuth() ë©”ì„œë“œê°€ ë‹¤ìŒ apië¥¼ ì œê³µí•œë‹¤

- /api/auth/login : ì• í”Œë¦¬ì¼€ì´ì…˜ì— ë¡œê·¸ì¸ í•  ìˆ˜ ìˆëŠ” api

- /api/auth/callback : Auth0ë¥¼ í†µí•´ ì„±ê³µì ìœ¼ë¡œ ë¡œê·¸ì¸í•œ ê²½ìš° ì‚¬ìš©ìë¥¼ ë‹¤ì‹œ ë˜ëŒë ¤ë³´ë‚´ëŠ” ì½œë°± url

- /api/auth/logout : ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ë¡œê·¸ì•„ì›ƒí•  ìˆ˜ ìˆëŠ” api

- /api/auth/me : ì‚¬ìš©ìê°€ ë¡œê·¸ì¸í•œ í›„ ì‚¬ìš©ì ì •ë³´ë¥¼ json í˜•íƒœë¡œ ê°€ì ¸ì˜¬ ìˆ˜ ìˆëŠ” ì—”ë“œ í¬ì¸íŠ¸
```

<br />

> 4. ëª¨ë“  í˜ì´ì§€ UserProviderë¡œ ë¬¶ê¸°

```js
// ë¸Œë¼ìš°ì €ì—ì„œ http://localhost:3000/api/auth/loginìœ¼ë¡œ ì ‘ê·¼í•˜ë©´ ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì ‘ê·¼ì´ ê°€ëŠ¥í•˜ë‹¤.
import { UserProvider } from "@auth0/nextjs-auth0";

export default function App({ Component, pageProps }) {
  return (
    <UserProvider>
      <Component {...pageProps} />
    </UserProvider>
  );
}
```

<br />

```js
import { useUser } from "@auth0/nextjs-auth0";

export default function Index() {
  const { user, error, isLoading } = useUser();

  if (isLoading) {
    return <div>Loading...</div>;
  }

  if (error) {
    return <div>{error.message}</div>;
  }

  if (user) {
    return (
      <div>
        <h1> Welcome back! </h1>
        <p> You're logged in with the following email address: {user.email}!</p>
        <a href="/api/auth/logout">Logout</a>
      </div>
    );
  }

  return (
    <div>
      <h1> Welcome, stranger! </h1>
      <p>
        Please <a href="/api/auth/login">Login</a>.
      </p>
    </div>
  );
}
```

<br />
<br />
<br />

---

## `next-auth ì‚¬ìš©`

- ì†Œì…œ ë¡œê·¸ì¸ ì‹œ ì‚¬ìš©ë˜ëŠ” í¸ë¦¬í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬

<br />

> 1. Nest-auth ì„¸íŒ…

```js
//page/api/auth/[...nextauth].js
import NextAuth from "next-auth";
import { GithubProvider, GoogleProvider } from "next-auth/providers/github";

export const authOptions = {
  providers: [
    GithubProvider({
      clientId: "id",
      clientSecret: "id_Secret",
    }),
    GoogleProvider({
      clientId: "id",
      clientSecret: "id_Secret",
    }),
  ],
  secret: "jwt_password",
};
export default NextAuth(authOptions);
```

<br />

> 2. ë¡œê·¸ì¸, ë¡œê·¸ì•„ì›ƒ ë²„íŠ¼ ìƒì„±

```js
"use client";
import { signIn, signOut } from "next-auth/react";

export default function Button() {
  return (
    <>
      <button
        onClick={() => {
          signIn();
        }}
      >
        ë²„íŠ¼
      </button>
    </>
  );
}
```

<br />

> 3. í˜„ì¬ ë¡œê·¸ì¸í•œ ìœ ì €ì˜ ì •ë³´ ê°€ì ¸ì˜¤ê¸°

```js
import { authOptions } from "@/pages/api/auth/[...nextauth]";
import { getServerSesstion } from "next-auth";

export default async function Page({}) {
  //í˜„ì¬ ë¡œê·¸ì¸í•œ ìœ ì € ì´ë¦„,ì´ë©”ì¼ ë“±ë“±ì„ ê°€ì ¸ì˜¬ ìˆ˜ ìˆìŒ
  //ì„œë²„ ì»´í¬ë„ŒíŠ¸ì—ì„œ ì‚¬ìš©ê°€ëŠ¥
  await getServerSesstion(authOptions);
  return <></>;
}
```

<br />
<br />

---

<br />
<br />

## Dynamic route

- ë¹„ìŠ·í•œ í´ë”ëª…ì´ ë§ì´ í•„ìš”í•  ë•Œ ì‚¬ìš©
- `detail/[sulg]/index.page.js`

<br />

> urlì •ë³´ ê°€ì ¸ì˜¤ê¸°

```js
//localhost:3000/detail/123
//detail/[sulg]/index.page.js
//ìœ ì €ê°€ urlì— ì…ë ¥í•œ ê°’ ê°€ì ¸ì˜¤ëŠ” ë°©ë²•
export default async function Page(props) {
  //urlì˜ paramsì˜ ì •ë³´ë¥¼ ê°€ì§€ê³  ìˆìŒ
  console.log(props);
  return <></>;
}
```

<br />
<br />

---

## useRouter

- `client componentì—ì„œë§Œ ì‚¬ìš©`

<br />

- `usePathname()` : í˜„ì¬ URL ì¶œë ¥
- `useSearchParams()` : Search parameter ì¶œë ¥
- `useParams()` : ìœ„ `Dynamic route` ì¶œë ¥

<br />
<br />

```js
// í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ ë Œë”ë§ ì‚¬ìš©
"use client";

import { useRouter } from "next/navigation";

export default async function Page(props) {
  let router = useRouter();
  return (
    <>
    {/* í˜ì´ì§€ ì´ë™ */}
    <div onClick-{()=>{router.push('/')}}/>
    {/* í˜ì´ì§€ ë’¤ë¡œê°€ê¸° */}
    <div onClick-{()=>{router.back()}}/>
    {/* í˜ì´ì§€ ì•ìœ¼ë¡œ ê°€ê¸° */}
    <div onClick-{()=>{router.forward()}}/>
    {/* í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨ */}
    <div onClick-{()=>{router.refresh()}}/>
    {/* í˜ì´ì§€ ë¯¸ë¦¬ë¡œë“œ */}
    <div onClick-{()=>{router.prefetch('/Detail')}}/>
    </>
  )
}
```

<br />
<br />

---

## static, dynamic rendering ìˆ˜ì •

- ë Œë”ë§ ë°©ì‹ ê°•ì œ ìˆ˜ì •

<br />

> ì˜ˆì‹œ

```js
// í˜ì´ì§€ static ë Œë”ë§ ë°©ì‹ìœ¼ë¡œ ê°•ì œ ë³€ê²½
export const dynamic = "force-static";
// í˜ì´ì§€ dynamic ëœë”ë§ ë°©ì‹ìœ¼ë¡œ ê°•ì œ ë³€ê²½
export const dynamic = "force-dynamic";

export default function Page() {
  return <></>;
}
```

<br />
<br />

## í˜ì´ì§€ ë‹¨ìœ„ ìºì‹± ê¸°ëŠ¥

- revaildate ì˜ˆì•½ ë³€ìˆ˜ ì‚¬ìš©

<br />

> í˜ì´ì§€ ë‹¨ìœ„ ìºì‹±

```js
//120ì´ˆ ìºì‹±
export default revalidate = 120;

export default async function Page() {
  return <></>;
}
```

---

<br />
<br />

## `Loading.js , error.js`

<br />

> í´í„° êµ¬ì¡°

```
/page
  - error.js
  - loading.js
  - page.js
  - not-found.js
```

> ëª¨ë“  page.js ì˜†ì— loading.js ìƒì„±í•˜ë©´ ë¡œë”© ì¤‘ ì»´í¬ë„ŒíŠ¸ë¥¼ ë„ìš°ê¸°

```js
//ë‚´ë¶€ì ìœ¼ë¡œ ë™ì‘í•˜ëŠ” ë°©ì‹
<Suspense fallback={loading.js}>{/*page.jsë‚´ìš©*/}</Suspense>
```

<br />

> error.js í˜ì´ì§€ì—ì„œ ì—ëŸ¬ ë‚¬ì„ ë•Œ error í˜ì´ì§€ ë³´ì—¬ì£¼ê¸°

```js
// í´ë¼ì´ì–¸íŠ¸ ì»´í¬ë„ŒíŠ¸ì—ë§Œ ì‚¬ìš© ê°€ëŠ¥
"use client";

//error : ì—ëŸ¬ì— ê´€í•œ ì •ë³´
//reset : í˜ì´ì§€ ë‹¤ì‹œ ë¡œë“œ
export default function Error({ error, reset }) {
  return <></>;
}
```

<br />

> 404í˜ì´ì§€ ìƒì„±

```js
import { notFound } from "next/navigation";

export default function Page() {
  //PageëŒ€ì‹  not-found.jsë¥¼ ëŒ€ì‹  ë³´ì—¬ì£¼ê²Œ ëœë‹¤.
  if (result === null) return notFound();
  return <></>;
}
```
