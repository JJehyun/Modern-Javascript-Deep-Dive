# JWT μΈμ¦ λ°©μ‹ π―π’΅π”¥π“β…

- `μΈμ¦μ— ν•„μ”ν• μ •λ³΄λ“¤μ„ μ•”νΈν™”μ‹ν‚¨ JSONν† ν°μ„ μλ―Έν•λ‹¤.`
- ν•λ‚μ μΈν„°λ„· ν‘μ¤€ μΈμ¦ λ°©μ‹, (μΈμ¦μ— ν•„μ”ν• μ •λ³΄λ“¤μ„ Tokenμ— λ‹΄μ•„ μ•”νΈν™”μ‹μΌ μ‚¬μ©ν•λ” ν† ν°)
- `JWT`λ” μ„λ…λ ν† ν°, `κ³µκ°/κ°μΈ` ν‚¤λ¥Ό μμΌλ΅ μ‚¬μ©ν•μ—¬ ν† ν°μ— μ„λ…ν•  κ²½μ°, ν† ν°μ€ κ°μΈ ν‚¤λ¥Ό λ³΄μ ν• μ„λ²„κ°€ μ΄ μ„λ…λ ν† ν°μ΄ μ •μƒμ μΈ ν† ν°μΈμ§€ μΈμ¦ κ°€λ¥
- `ν† ν°μ€ μ„Έμ…κ³Όλ” λ‹¬λ¦¬ μ„λ²„κ°€ μ•„λ‹ ν΄λΌμ΄μ–ΈνΈμ— μ €μ¥λκΈ° λ•λ¬Έμ— μ„λ²„μ λ¶€λ‹΄μ„ λ μ£Όκ² λλ‹¤.`

```
β… ν† ν° μμ²΄μ— μ‚¬μ©μμ κ¶ν• μ •λ³΄λ‚ μ„λΉ„μ¤λ¥Ό μ‚¬μ©ν•κΈ° μ„ν• μ •λ³΄κ°€ ν¬ν•¨ λλ‹¤λ” κ²ƒ

β… jwtλ¥Ό μ‚¬μ©ν•λ©΄ RESTfulκ³Ό κ°™μ€ λ¬΄μƒνƒμΈ ν™κ²½μ—μ„ μ‚¬μ©μ λ°μ΄ν„°λ¥Ό μ£Όκ³  λ°›μ„ μ μλ‹¤.
  - ν΄λΌμ΄μ–ΈνΈμ— μ €μ¥ν•κ³  μ”μ²­μ‹ λ‹¨μν HTTP ν—¤λ”μ— ν† ν°μ„ μ²¨λ¶€ν•λ” κ²ƒλ§μΌλ΅λ„ λ‹¨μν•κ² λ°μ΄ν„°λ¥Ό μ”μ²­ν•κ³  μ‘λ‹µ λ°›μ•„μ¬ μ μλ‹¤.
β… jwtν† ν°μ„ HTTP ν—¤λ”μ— μ‹¤μ–΄ μ„λ²„κ°€ ν΄λΌμ΄μ–ΈνΈλ¥Ό μ‹λ³„ν•λ” λ°©μ‹μ΄λ‹¤.

β… JSON λ°μ΄ν„°λ¥Ό Base64 URL-safe Encode λ¥Ό ν†µν•΄ μΈμ½”λ”©ν•μ—¬ μ§λ ¬ν™”ν• κ²ƒμ΄λ©°, ν† ν° λ‚΄λ¶€μ—λ” μ„λ³€μ΅° λ°©μ§€λ¥Ό μ„ν•΄ κ°μΈν‚¤λ¥Ό ν†µν• μ „μμ„λ…λ„ λ“¤μ–΄μλ‹¤
```

<br />
<br />

## JWTλ” .μΌλ΅ κµ¬λ¶„μ΄ λμ–΄ μμΌλ©°, κµ¬μ„±μ”μ†λ” 3κ°€μ§€ μ΄λ‹¤.

- `Header`
  - ν† ν°μ νƒ€μ…, μ„λ… μƒμ„±μ— μ–΄λ–¤ μ•κ³ λ¦¬μ¦μ΄ μ‚¬μ©λμ—λ”μ§€ μ €μ¥ν•λ‹¤.
- `Payload`

  - payloadμ—λ” λ―Όκ°ν• μ •λ³΄λ¥Ό λ„£μ§€ μ•λ”λ‹¤.
  - Claimμ΄λΌλ” μ‚¬μ©μμ— λ€ν• μ •λ³΄λ¥Ό λ‹΄λ”λ‹¤. (key-value)κ°’μ— μ €μ¥ν•λ‹¤.
  - Claimμ ν‘μ¤€ μ¤ν™ : `7κ°€μ§€` (μ‚¬μ©μμ— λ”°λΌ μ„ νƒμ‚¬ν•­)
    - `iss` : ν† ν° λ°κΈ‰μ
    - `sub` : ν† ν° μ λ© (`ν† ν°μ—μ„ μ‚¬μ©μμ— λ€ν• μ‹λ³„ κ°’μ΄ λ¨`)
    - `aud` : ν† ν° λ€μƒμ
    - `exp` : λ§λ£μ‹κ°„
    - `nbf` : ν† ν° ν™μ„± μ‹κ°„
    - `iat` : ν† ν° λ°κΈ‰ μ‹κ°„
    - `jti` : JWT ν† ν° μ‹λ³„μ

- `Signature` (μ„λ…)
  - Headerμ™€ Payloadλ¥Ό λ³΄μ—¬μ¤„ λ•λ” μΈμ½”λ”© λμ–΄μλ κ°’λ“¤μ„ JWTμ— λ‹΄κ²¨μλ” κ²ƒμ²λΌ λ””μ½”λ”©λ μƒνƒλ¥Ό μ‚¬μ©ν•λ‹¤.
  - `Signature`λ” μ„λ²„μ— μλ” κ°μΈν‚¤λ΅λ§ μ•”νΈν™”λ¥Ό ν’€ μ μμΌλ―€λ΅ λ‹¤λ¥Έ ν΄λΌμ΄μ–ΈνΈλ” μ„μλ΅ `Signature`λ¥Ό λ³µνΈν™”ν•  μ μ—†λ‹¤.

<br />
<br />

## JWT μ§„ν–‰ λ°©μ‹

1. ν΄λΌμ΄μ–ΈνΈμ—μ„ λ΅κ·ΈμΈ
2. μ„λ²„μ—μ„ μ„λ…λ jwtλ¥Ό μƒμ„±ν•΄μ„ ν΄λΌμ΄μ–ΈνΈμ— μ‘λ‹µ λλ ¤μ£ΌκΈ°
3. ν΄λΌμ΄μ–ΈνΈμ—μ„ λ°μ΄ν„°λ¥Ό μ”κµ¬ν•  λ• jwtλ¥Ό ν•΄λ”μ— μ²¨λ¶€ν•΄μ„ μ”μ²­
4. μ„λ²„μ—μ„ jwtκ²€μ¦

<br />
<br />

## JWT κΈ°λ³Έ κµ¬μ΅°

![image](../image/jwt1.png)

<br />
<br />

---

> Header

```json
{
  //μ„λ… μ•”νΈν™” μ•κ³ λ¦¬μ¦
  "alg": "HS256",
  //ν† ν° μ ν•
  "typ": "JWT"
}
```

<br />

> Payload

```json
// ν† ν°μ—μ„ μ‚¬μ©ν•  μ •λ³΄μ μ΅°κ°λ“¤μΈ Claimμ΄ λ‹΄κ²¨ μλ‹¤.
// μ„λ²„μ™€ ν΄λΌμ΄μ–ΈνΈκ°€ μ£Όκ³ λ°›λ” μ‹μ¤ν…μ—μ„ μ‹¤μ λ΅ μ‚¬μ©λ  μ •λ³΄μ— λ€ν• λ‚΄μ©μ„ λ‹΄κ³  μλ‹¤.
{
  "sub": "123",
  "name": "je",
  "iat": 156239200,
  "exp": 165234200
}
```

<br />

> Signature

```json
// μ‹κ·Έλ‹μ²μ—μ„ μ‚¬μ©ν•λ” μ•κ³ λ¦¬μ¦μ€ ν—¤λ”μ—μ„ μ •μν• λ°©μ‹μ„ ν™μ©ν•λ‹¤.
// μ‹κ·Έλ‹μ² κµ¬μ΅°λ” (ν—¤λ” + νμ΄λ΅λ“)μ™€ μ„λ²„κ°€ κ°–κ³  μλ” μ μΌν• keyκ°’μ„ ν•©μΉ κ²ƒμ„ ν—¤λ”μ—μ„ μ •ν¬ν• μ•κ³ λ¦¬μ¦μΌλ΅ μ•”νΈν™”ν•λ‹¤.
HMACSHA256(
    base64UrlEncode(header) + "." +
    base64UrlEncode(payload),
    ...
)
```

<br />
<br />

# JWT.ioμ—μ„ μΈμ½”λ”©, λ””μ½”λ”© κ°€λ¥

```
π’΅ JWTμ€ μ„λ…μΈμ¦μ΄ λ©μ μ΄λ‹¤.
- jwtλ” base64λ΅ μ•”νΈν™”ν•κΈ° λ•λ¬Έμ— λ””λ²„κ±°λ¥Ό ν†µν•΄ λ°”λ΅ λ³µνΈν™”λ¥Ό ν•  μ μλ‹¤. λ•λ¬Έμ— μ‚¬μ©μ λ°μ΄ν„°λ¥Ό λ‹΄μ€ payloadλ¶€λ¶„μ΄ κ·Έλ€λ΅ λ…Έμ¶λμ–΄ λ²„λ¦°λ‹¤.

- playloadμ—λ” λ―Όκ°ν• μ •λ³΄λ¥Ό λ„£μΌλ©΄ μ•λλ‹¤.

- jwtμΈμ¦ λ°©μ‹μ€ μ •λ³΄ λ³΄νΈκ°€ μ•„λ‹μ„μ΅° λ°©μ§€κ°€ λ©μ μ΄λ‹¤.
  - μ‹κ·Έλ‹μ²μ— μ‚¬μ©λ λΉ„λ°€ν‚¤κ°€ λ…Έμ¶λμ§€ μ•λ” μ΄μƒ λ°μ΄ν„°λ¥Ό μ„μ΅°ν•΄λ„ μ‹κ·Έλ‹μ² λ¶€λ¶„μ—μ„ λ°”λ΅ κ±Έλ¬μ§„λ‹¤.
```
